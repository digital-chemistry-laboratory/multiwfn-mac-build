--- util.f90	2022-06-13 13:03:44.000000000 -0400
+++ util.f90	2022-06-14 22:16:22.000000000 -0400
@@ -1910,22 +1910,28 @@
 ncol=5
 n1=size(mat,1)
 n2=size(mat,2)
-if (present(usern1).and.usern1/=-1) n1=usern1
-if (present(usern2).and.usern1/=-1) n2=usern2
+if (present(usern1)) then
+	if (usern1/=-1) n1=usern1
+end if
+if (present(usern2)) then
+	if (usern1/=-1) n2=usern2
+end if
 if (present(insemi)) semi=insemi
 if (present(fileid)) ides=fileid
 if (present(inncol)) ncol=inncol
-if (present(label).and.label/='') then
-	nspc=int((79-len(label))/2D0)
-    write(ides,"(a)",advance='no') " "
-	do i=1,nspc-2
-		write(ides,"(a)",advance='no') '*'
-	end do
-	write(ides,"(a)",advance='no') ' '//label//' '
-	do i=1,nspc-2
-		write(ides,"(a)",advance='no') '*'
-	end do
-    write(ides,*)
+if (present(label)) then
+	if (label/='') then
+		nspc=int((79-len(label))/2D0)
+  	  write(ides,"(a)",advance='no') " "
+		do i=1,nspc-2
+			write(ides,"(a)",advance='no') '*'
+		end do
+		write(ides,"(a)",advance='no') ' '//label//' '
+		do i=1,nspc-2
+			write(ides,"(a)",advance='no') '*'
+		end do
+  	  write(ides,*)
+	end if
 end if
 nf=ceiling(n2/float(ncol))
 do i=1,nf !How many frame
@@ -2087,7 +2093,11 @@
 integer,optional :: ifound,irewind,maxline
 character c200*200
 CHARACTER(LEN=*) label
-if ((.not.present(irewind)).or.(present(irewind).and.irewind==1)) rewind(fileid)
+if (.not. present(irewind)) then
+  rewind(fileid)
+else
+  if (irewind==1) rewind(fileid)
+end if
 if (.not.present(maxline)) then
 	do while(.true.)
 		read(fileid,"(a)",iostat=ierror) c200
